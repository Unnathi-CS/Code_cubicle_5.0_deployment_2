<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Slack Dashboard - Real-time Analytics</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <style>
    /* Custom Tailwind Configuration & Variables */
    :root {
      --primary-800: #312E81; /* Indigo-800 */
      --primary-700: #4338CA; /* Indigo-700 */
      --primary-600: #4F46E5; /* Indigo-600 */
      --primary-500: #6366F1; /* Indigo-500 */
    }
    
    .material-symbols-outlined {
      font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
      user-select: none;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: rgb(239 246 255); 
      margin: 0;
      padding: 0;
    }

    /* --- Custom Collapsible Sidebar Styles --- */

    /* 1. Sidebar Default State (Collapsed: 4rem) */
    .sidebar {
      width: 4rem;
      transition: width 0.3s ease-in-out;
      z-index: 20;
      position: fixed;
      height: 100vh;
      left: 0;
      top: 0;
      border-right: 1px solid rgb(229 231 235); /* gray-200 */
    }

    /* 2. Expand the sidebar only on hover (Desktop: > 768px) */
    @media (min-width: 769px) {
      .sidebar:hover {
        width: 16rem; /* Expanded: 16rem */
      }

      /* 3. Shift Main Content with Sidebar expansion and dynamic width */
      .main-content-wrapper {
        transition: margin-left 0.3s ease-in-out, width 0.3s ease-in-out;
        margin-left: 4rem; /* Initial offset equal to collapsed sidebar width */
        width: calc(100% - 4rem); /* Occupy remaining width */
      }

      /* 4. Update Main Content margin and width when sidebar is hovered/expanded */
      .sidebar:hover ~ .main-content-wrapper {
        margin-left: 16rem; /* Margin equal to expanded sidebar width */
        width: calc(100% - 16rem); /* Occupy remaining width */
      }
    }
    
    /* 5. Hide text content by default and show on hover */
    .sidebar-text {
      opacity: 0;
      white-space: nowrap;
      transition: opacity 0.1s ease 0.1s; /* Delay opacity transition */
      overflow: hidden; /* Ensure text doesn't peek */
    }

    .sidebar:hover .sidebar-text {
      opacity: 1;
    }
    
    /* Sidebar Link Active State */
    .sidebar-link.active {
      background-color: var(--primary-600);
      color: white;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      border-radius: 6px; 
    }

    /* Sidebar Link Hover/Focus State for non-active links */
    .sidebar-link:not(.active):hover {
      background-color: rgb(238 242 255); /* Tailwind indigo-50 */
      color: var(--primary-600);
      border-radius: 6px;
    }

    /* Mobile Responsive Overrides (<= 768px) */
    @media (max-width: 768px) {
      .sidebar {
        /* Sidebar stays visible (width: 4rem by default) */
        width: 4rem;
        /* Use absolute positioning to prevent shifting content on hover */
        position: absolute; 
        height: 100%; /* Use 100% height instead of 100vh on mobile to prevent layout issues */
        box-shadow: 2px 0 5px rgba(0, 0, 0, 0.3);
      }
      .sidebar:hover {
           width: 16rem; /* Expands over content */
      }
      
      /* Main content wrapper always starts at 4rem and does not change width */
      .main-content-wrapper {
        margin-left: 4rem; /* Always push content over by 4rem (collapsed width) */
        width: calc(100% - 4rem); 
      }
      
      .hidden-mobile {
        display: none;
      }
    }
  </style>
</head>
<body class="bg-gray-100">
  <div id="webcrumbs">
    <div class="flex relative">
      <!-- Sidebar -->
      <div class="sidebar bg-blue-50 flex flex-col items-center group">
        <div class="flex items-center justify-center p-4 text-gray-800 w-full h-16 border-b border-gray-200 flex-shrink-0">
          <span class="material-symbols-outlined text-2xl flex-shrink-0 text-gray-800">data_thresholding</span>
          <span class="ml-4 font-semibold sidebar-text"></span>
        </div>
        <nav class="flex-1 w-full overflow-y-auto pt-2 px-2">
          <ul class="space-y-1">
            <li class="px-2 py-2 text-gray-700 flex items-center sidebar-link {% if request.endpoint == 'landing' %}active{% endif %}">
              <a href="{{ url_for('landing') }}" class="flex items-center w-full">
                <span class="material-symbols-outlined mr-3 flex-shrink-0">home</span>
                <span class="sidebar-text">Home</span>
              </a>
            </li>
            <li class="px-2 py-2 text-gray-700 flex items-center sidebar-link {% if request.endpoint == 'dashboard' %}active{% endif %}">
              <a href="{{ url_for('dashboard') }}" class="flex items-center w-full">
                <span class="material-symbols-outlined mr-3 flex-shrink-0">analytics</span>
                <span class="sidebar-text">Slack Dashboard</span>
              </a>
            </li>
            <li class="px-2 py-2 text-gray-700 flex items-center sidebar-link {% if request.endpoint == 'chatbot' %}active{% endif %}">
              <a href="{{ url_for('chatbot') }}" class="flex items-center w-full">
                <span class="material-symbols-outlined mr-3 flex-shrink-0">robot</span>
                <span class="sidebar-text">AI Chat Bot</span>
              </a>
            </li>
          </ul>
          <div class="text-gray-500 text-xs uppercase px-2 pt-4 pb-2 mt-4 border-t border-gray-200 sidebar-text">Account</div>
          <ul class="space-y-1">
            <li class="px-2 py-2 text-gray-700 flex items-center sidebar-link">
              <span class="material-symbols-outlined mr-3 flex-shrink-0">settings</span>
              <span class="sidebar-text">Settings</span>
            </li>
            <li class="px-2 py-2 text-gray-700 flex items-center sidebar-link">
              <span class="material-symbols-outlined mr-3 flex-shrink-0">person</span>
              <span class="sidebar-text">Profile</span>
            </li>
            <li class="px-2 py-2 text-gray-700 flex items-center sidebar-link relative">
              <span class="material-symbols-outlined mr-3 flex-shrink-0">notifications</span>
              <span class="sidebar-text">Notifications</span>
              <span class="ml-auto text-xs font-semibold bg-red-500 rounded-full px-2 sidebar-text text-white">12</span>
            </li>
            <li class="px-2 py-2 text-gray-700 flex items-center sidebar-link">
              <span class="material-symbols-outlined mr-3 flex-shrink-0">logout</span>
              <span class="sidebar-text">Logout</span>
            </li>
          </ul>
        </nav>
      </div>
      <!-- Main Content -->
      <div class="main-content-wrapper flex flex-col min-h-screen">
        <header class="bg-white shadow-sm p-4 flex items-center justify-between flex-shrink-0">
          <div class="flex items-center">
            <h1 class="text-xl font-semibold text-gray-800">Slack Dashboard</h1>
            <div class="ml-6 flex items-center text-sm text-gray-600">
              <span class="flex items-center">
                <span class="material-symbols-outlined mr-1 text-green-500 text-base">circle</span> Live Monitoring Active
              </span>
              <span class="mx-2">|</span>
              <span><span class="font-medium" id="lastUpdate"></span></span>
            </div>
          </div>
          <div class="flex items-center space-x-4">
            <div class="relative hidden md:block">
              <input
                type="text"
                placeholder="Search..."
                class="pl-10 pr-4 py-2 border rounded-full focus:outline-none focus:ring-2 focus:ring-[color:var(--primary-500)] focus:border-[color:var(--primary-500)] transition-all"
              />
              <span class="material-symbols-outlined absolute left-3 top-2.5 text-gray-400">search</span>
            </div>
            <button class="p-2 rounded-full hover:bg-gray-100 transition-colors relative" id="refreshBtn">
              <span class="material-symbols-outlined">refresh</span>
              <span class="absolute top-0 right-0 w-2.5 h-2.5 bg-red-500 rounded-full animate-pulse"></span>
            </button>
          </div>
        </header>
        <main class="flex-1 p-6 sm:p-8">
          <!-- Statistics Cards -->
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow">
              <div class="flex justify-between items-center">
                <div>
                  <p class="text-gray-500 text-sm font-medium">Total Messages</p>
                  <h3 class="text-3xl font-bold mt-1" id="totalMessages">0</h3>
                  <p class="text-green-500 text-xs mt-2 flex items-center">
                    <span class="material-symbols-outlined text-sm mr-1">trending_up</span>
                    <span id="statActiveUsersTrend">+0 from last hour</span>
                  </p>
                </div>
                <div class="bg-blue-100 p-3 rounded-full">
                  <span class="material-symbols-outlined text-blue-500 text-xl">forum</span>
                </div>
              </div>
            </div>
            <div class="bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow">
              <div class="flex justify-between items-center">
                <div>
                  <p class="text-gray-500 text-sm font-medium">Active Users</p>
                  <h3 class="text-3xl font-bold mt-1" id="uniqueUsers">0</h3>
                  <p class="text-yellow-500 text-xs mt-2 flex items-center">
                    <span class="material-symbols-outlined text-sm mr-1">person</span>
                    <span id="statMessagesTrend">Stable from last hour</span>
                  </p>
                </div>
                <div class="bg-yellow-100 p-3 rounded-full">
                  <span class="material-symbols-outlined text-yellow-500 text-xl">group</span>
                </div>
              </div>
            </div>
            <div class="bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow">
              <div class="flex justify-between items-center">
                <div>
                  <p class="text-gray-500 text-sm font-medium">Questions</p>
                  <h3 class="text-3xl font-bold mt-1" id="questionsCount">0</h3>
                  <p class="text-green-500 text-xs mt-2 flex items-center">
                    <span class="material-symbols-outlined text-sm mr-1">help</span>
                    <span id="statQuestionsTrend">0 urgent tasks</span>
                  </p>
                </div>
                <div class="bg-green-100 p-3 rounded-full">
                  <span class="material-symbols-outlined text-green-500 text-xl">question_mark</span>
                </div>
              </div>
            </div>
            <div class="bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow">
              <div class="flex justify-between items-center">
                <div>
                  <p class="text-gray-500 text-sm font-medium">Problems / Errors</p>
                  <h3 class="text-3xl font-bold mt-1" id="problemsCount">0</h3>
                  <p class="text-red-500 text-xs mt-2 flex items-center">
                    <span class="material-symbols-outlined text-sm mr-1">bug_report</span>
                    <span id="statProblemsTrend">Action required</span>
                  </p>
                </div>
                <div class="bg-red-100 p-3 rounded-full">
                  <span class="material-symbols-outlined text-red-500 text-xl">error</span>
                </div>
              </div>
            </div>
          </div>
          <!-- RECENT MESSAGES -->
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="bg-white rounded-xl shadow-md md:col-span-2 overflow-hidden">
              <div class="p-4 border-b">
                <h3 class="font-semibold text-gray-800 text-lg">Recent Messages</h3>
              </div>
              <div class="overflow-y-auto max-h-[500px]" id="recentMessages">
                <p class="text-gray-500 text-center py-4">Loading messages...</p>
              </div>
            </div>
            <!-- AI INSIGHTS -->
            <div class="bg-white rounded-xl shadow-md p-6">
              <h3 class="font-semibold text-gray-800 text-lg mb-4">AI Insights</h3>
              <div class="space-y-4">
                <div class="p-4 bg-red-50 border-l-4 border-red-500 rounded-r-md">
                  <div class="flex items-center">
                    <span class="material-symbols-outlined text-red-500 mr-2">warning</span>
                    <h4 class="text-base font-medium text-gray-800">Current Problems</h4>
                  </div>
                  <p class="text-sm text-gray-600 mt-1" id="problemsInsight">
                    Loading AI analysis...
                  </p>
                </div>
                <div class="p-4 bg-yellow-50 border-l-4 border-yellow-500 rounded-r-md">
                  <div class="flex items-center">
                    <span class="material-symbols-outlined text-yellow-500 mr-2">info</span>
                    <h4 class="text-base font-medium text-gray-800">Top Questions</h4>
                  </div>
                  <p class="text-sm text-gray-600 mt-1" id="questionsInsight">